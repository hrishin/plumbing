apiVersion: batch/v1beta1
kind: CronJob
metadata:
  labels:
    name: cron-openshift-ci-nightly
  name: cron-openshift-ci-nightly-cron
spec:
  schedule: "0 2 * * *"
  concurrencyPolicy: "Forbid"
  startingDeadlineSeconds: 200
  suspend: false
  successfulJobsHistoryLimit: 3
  failedJobsHistoryLimit: 1
  jobTemplate:
    spec:
      template:
        metadata:
          labels:
            parent: "openshift-ci-nightly"
        spec:
          containers:
          - name: launch-nightly
            image: quay.io/chmouel/hub-git
            command: ["/bin/bash"]
            args: ["-c", "git clone --depth=1 https://github.com/chmouel/scratchpad /tmp/scratchpad && cd /tmp/scratchpad && git config user.email chmouzies@chmouel.com && git config user.name chmouzies && ./new-pull-request.sh"]
          restartPolicy: OnFailure
